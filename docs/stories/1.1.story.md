# Story 1.1: 이메일/비밀번호 회원가입

## Status
Ready for Review

## Story
**As a** 새로운 사용자,
**I want** 이메일과 비밀번호로 회원가입할 수 있도록,
**so that** AI 메모장 서비스를 이용할 수 있다

## Acceptance Criteria
1. 사용자가 이메일과 비밀번호를 입력하여 회원가입할 수 있다
2. 이메일 형식이 유효하지 않으면 에러 메시지를 표시한다
3. 비밀번호가 8자 이상이 아니면 에러 메시지를 표시한다
4. 이미 존재하는 이메일로 회원가입 시도 시 에러 메시지를 표시한다
5. 회원가입 성공 시 자동으로 로그인 상태가 된다
6. 회원가입 성공 시 사용자를 메인 페이지로 리다이렉트한다

## Tasks / Subtasks
- [x] Supabase Auth 설정 및 환경 변수 구성 (AC: 1, 5)
  - [x] Supabase 프로젝트 설정 확인
  - [x] 환경 변수 파일 생성 (.env.local)
  - [x] Supabase 클라이언트 설정
- [x] 회원가입 UI 컴포넌트 구현 (AC: 1, 2, 3, 4)
  - [x] 이메일 입력 필드 (유효성 검사 포함)
  - [x] 비밀번호 입력 필드 (길이 검사 포함)
  - [x] 에러 메시지 표시 컴포넌트
  - [x] 회원가입 버튼
- [x] 회원가입 서버 액션 구현 (AC: 1, 2, 3, 4, 5)
  - [x] 이메일/비밀번호 유효성 검사
  - [x] Supabase Auth signUp 호출
  - [x] 에러 핸들링 및 사용자 피드백
- [x] 회원가입 성공 후 처리 (AC: 5, 6)
  - [x] 자동 로그인 처리
  - [x] 메인 페이지 리다이렉트
- [x] 테스트 작성
  - [x] 회원가입 성공 케이스 테스트
  - [x] 유효성 검사 실패 케이스 테스트
  - [x] 중복 이메일 에러 케이스 테스트

## Dev Notes

### 기술 스택 정보
- **프레임워크:** Next.js (App Router, Server Actions) [Source: architecture.md#1]
- **UI:** shadcn/ui + Tailwind + Radix UI [Source: architecture.md#1]
- **DB/인증:** Supabase (Postgres, Auth, Storage) [Source: architecture.md#1]
- **호스팅:** Vercel (Preview/Prod) [Source: architecture.md#1]

### 데이터 모델
- 사용자 인증은 Supabase Auth를 통해 처리되며 별도의 사용자 테이블은 필요하지 않음
- 인증된 사용자의 user_id는 Supabase에서 자동 생성됨

### 보안 요구사항
- **권한 스코프:** 모든 인증 관련 로직은 Supabase Auth를 통해 처리 [Source: architecture.md#3]
- **키 관리:** Supabase 서비스 롤 키는 서버 전용 [Source: architecture.md#3]

### 파일 구조
- 회원가입 페이지: `app/auth/signup/page.tsx`
- 회원가입 서버 액션: `app/auth/signup/actions.ts`
- 회원가입 UI 컴포넌트: `components/auth/signup-form.tsx`
- 환경 변수: `.env.local`

### API 명세
- Supabase Auth API 사용:
  - `supabase.auth.signUp({ email, password })`
  - 에러 타입: `AuthError` (이메일 중복, 유효성 검사 실패 등)

### Testing
- **테스트 프레임워크:** Jest + React Testing Library
- **테스트 파일 위치:** `__tests__/auth/signup.test.tsx`
- **테스트 표준:**
  - 컴포넌트 렌더링 테스트
  - 사용자 상호작용 테스트 (폼 제출, 에러 표시)
  - 서버 액션 테스트 (성공/실패 케이스)
  - Supabase Auth 모킹 필요

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-19 | 1.0 | 초기 스토리 생성 | Bob (SM) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5

### Debug Log References
없음

### Completion Notes List
- Supabase Auth 설정 완료 (.env.local에 환경 변수 설정 필요)
- shadcn/ui 컴포넌트 수동 설치 (button, input, label, card)
- 회원가입 폼 유효성 검사 구현 (이메일 형식, 비밀번호 길이, 비밀번호 확인)
- 서버 액션으로 Supabase Auth signUp 처리
- Jest 테스트 환경 설정 및 7개 테스트 케이스 작성 (모두 통과)
- HTML5 input type="email" validation 고려한 테스트 작성

### File List
- `.env.local` - Supabase 환경 변수 설정 파일
- `lib/supabase/client.ts` - 클라이언트 사이드 Supabase 클라이언트
- `lib/supabase/server.ts` - 서버 사이드 Supabase 클라이언트
- `components/ui/button.tsx` - Button 컴포넌트
- `components/ui/input.tsx` - Input 컴포넌트
- `components/ui/label.tsx` - Label 컴포넌트
- `components/ui/card.tsx` - Card 컴포넌트
- `components/auth/signup-form.tsx` - 회원가입 폼 컴포넌트
- `app/auth/signup/actions.ts` - 회원가입 서버 액션
- `app/auth/signup/page.tsx` - 회원가입 페이지
- `jest.config.js` - Jest 설정 파일
- `jest.setup.js` - Jest 설정 파일
- `__tests__/auth/signup.test.tsx` - 회원가입 테스트 파일
- `package.json` - 의존성 및 스크립트 설정

## QA Results
*QA 에이전트가 검토 후 채워집니다*
